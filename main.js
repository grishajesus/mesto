(()=>{"use strict";class e{constructor(e){this.popup=document.querySelector(e)}open(){this.popup&&(this.popup.style.display="flex",this.popup.classList.add("popup_opened"),this.popup.addEventListener("click",this._handleClickOverlayClose.bind(this)),document.body.addEventListener("keydown",this._handleEscClose.bind(this)))}close(){this.popup&&(this.popup.classList.remove("popup_opened"),this.popup.removeEventListener("click",this._handleClickOverlayClose.bind(this)),document.body.removeEventListener("keydown",this._handleEscClose.bind(this)))}setEventListeners(){this.popup.querySelector(".popup__close-button").addEventListener("click",(()=>this.close()))}_handleClickOverlayClose(e){e.target.classList.contains("popup")&&this.close(this.popup)}_handleEscClose(e){"Escape"===e.code&&null!==this.popup&&this.close()}}class t extends e{constructor(e,t){super(e),this.onSubmitForm=t}close(){super.close(),this.popup.querySelector("form").reset()}setEventListeners(){super.setEventListeners(),this.popup.querySelector("form").addEventListener("submit",this.onSubmitForm.bind(this))}_getInputValues(e){return Object.fromEntries(new FormData(e.target))}}const s={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_error",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"};class r{constructor(e,t){this.form=document.querySelector(e),this.selectors=t}_setEventListeners(){this.form.querySelectorAll(this.selectors.inputSelector).forEach((e=>{e.addEventListener("input",(()=>{this._setInputListener(e),this._checkIsPossibleSubmit()}))}))}_setInputListener(e){const t=this.form.querySelector(`#${e.name}-error`),s=e.validity;let r="";e.value.length?s.tooShort||s.tooLong?r=`Неправильно заполнено поле! Введено ${e.value.length}, должно быть от ${e.getAttribute("minlength")} до ${e.getAttribute("maxlength")}`:s.typeMismatch&&(r="Это не ссылка"):r="Вы пропустили это поле",r?(e.classList.add(this.selectors.inputErrorClass),t.classList.add(this.selectors.errorClass)):(e.classList.remove(this.selectors.inputErrorClass),t.classList.remove(this.selectors.errorClass)),t.textContent=r}_checkIsPossibleSubmit(){const e=this.form.querySelector(this.selectors.submitButtonSelector);this.form.checkValidity()?(e.classList.remove(this.selectors.inactiveButtonClass),e.removeAttribute("disabled")):(e.classList.add(this.selectors.inactiveButtonClass),e.setAttribute("disabled","disabled"))}enableValidation(){this._checkIsPossibleSubmit(),this._setEventListeners()}}class n{constructor(e,t,s){this.place=e,this.templateSelector=document.querySelector(t),this.handleCardClick=s}_shapeElementFromTemplate(){const e=this.templateSelector.content.querySelector(".place-card").cloneNode(!0),t=e.querySelector(".place-card__name"),s=e.querySelector(".place-card__image");return t.textContent=this.place.title,s.src=this.place.link,s.alt=this.place.title||this.place.name,e}_handleDelete(e){e.remove()}_handleToggleLike(e){e.target.classList.toggle("place-card__like-icon_active")}_setListeners(e){e.querySelector(".place-card__delete").addEventListener("click",(()=>this._handleDelete(e))),e.querySelector(".place-card__like-icon").addEventListener("click",(e=>this._handleToggleLike(e))),e.querySelector(".place-card__image").addEventListener("click",(()=>this.handleCardClick(this.place.link,this.place.title)))}createDOMNode(){const e=this._shapeElementFromTemplate();return this._setListeners(e),e}}const o=new class{constructor(e,t){this.name=document.querySelector(e),this.description=document.querySelector(t)}getUserInfo(){return{name:this.name.textContent,description:this.description.textContent}}setUserInfo(e,t){this.name.textContent=e,this.description.textContent=t}}(".profile__name",".profile__job"),i=new class extends e{open(e,t){this.popup.querySelector(".popup-image__image").src=e,this.popup.querySelector(".popup-image__title").textContent=t,super.open()}}(".popup_type_image");i.setEventListeners();const l=new class{constructor(e,t){this.items=e.items,this.renderer=e.renderer,this.container=document.querySelector(t)}addItem(e){this.container.prepend(e)}render(){if(0===this.items.length||!this.renderer)return null;this.items.forEach((e=>this.renderer(e)))}}({items:[{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=new n(e,"#place-card-template",i.open.bind(i)).createDOMNode();l.addItem(t)}},"#places-list");l.render();const c=new r('form[name="place-add-card__form"]',s),p=new t(".popup_type_card-add",(function(e){e.preventDefault();const t=this._getInputValues(e),s=new n(t,"#place-card-template").createDOMNode();l.addItem(s),this.close()}));p.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{c.enableValidation(),p.open()}));const a=new r('form[name="profile-settings__form"]',s),d=a.form.querySelector('input[name="name"]'),u=a.form.querySelector('input[name="about"]'),h=new t(".popup_type_profile",(function(e){e.preventDefault();const t=this._getInputValues(e);o.setUserInfo(t.name,t.about),this.close()}));h.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{const{name:e,description:t}=o.getUserInfo();d.value=e,u.value=t,a.enableValidation(),h.open()}))})();